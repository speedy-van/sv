# Dual Routing System - Quick Start Guide
## Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹ - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬

---

## ğŸ¯ Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ

**Ù†Ø¸Ø§Ù… ØªÙˆØ¬ÙŠÙ‡ Ø°ÙƒÙŠ Ù…Ø²Ø¯ÙˆØ¬ ÙŠØ¯Ø¹Ù…:**
- âš¡ **Auto Mode** - ØªØ¬Ù…ÙŠØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¬ÙˆØ²Ø§Øª ÙÙŠ Ø·Ø±Ù‚ Ù…Ø­Ø³Ù‘Ù†Ø©
- ğŸ–ï¸ **Manual Mode** - Ø¥Ù†Ø´Ø§Ø¡ ÙŠØ¯ÙˆÙŠ Ù„Ù„Ø·Ø±Ù‚ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø£Ø¯Ù…Ù†
- âœ… **Approval System** - Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø·Ø±Ù‚ Ù‚Ø¨Ù„ Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù„Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†
- ğŸ“Š **Full Audit Trail** - ØªØªØ¨Ø¹ ÙƒØ§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª

---

## âš™ï¸ Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ø³Ø±ÙŠØ¹ (5 Ø¯Ù‚Ø§Ø¦Ù‚)

### 1. ØªØ´ØºÙŠÙ„ Migration
```bash
cd packages/shared
pnpm run prisma:migrate
```

### 2. Ø¥Ø¶Ø§ÙØ© Environment Variables
```bash
# In .env.local
CRON_SECRET=your_secure_secret_here
```

### 3. Initialize Settings
Ø§ÙØªØ­ Prisma Studio:
```bash
cd packages/shared
pnpm run prisma:studio
```

Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ `SystemSettings` â†’ Add Record:
```json
{
  "routingMode": "manual",
  "autoRoutingEnabled": false,
  "autoRoutingIntervalMin": 15,
  "maxDropsPerRoute": 10,
  "maxRouteDistanceKm": 50,
  "autoAssignDrivers": false,
  "requireAdminApproval": true,
  "minDropsForAutoRoute": 2,
  "updatedBy": "system"
}
```

### 4. Deploy
```bash
cd apps/web
pnpm run build
```

âœ… **Done! Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø².**

---

## ğŸš€ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠ

### Scenario 1: ØªÙØ¹ÙŠÙ„ Auto Mode

**From Admin Dashboard:**
1. Ø§ÙØªØ­ `/admin/dashboard`
2. Ø³ØªØ¬Ø¯ **Routing Mode Toggle** ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰
3. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Switch â†’ Ø³ÙŠØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ **AUTO**
4. Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¢Ù† ÙŠØ´ØªØºÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ 15 Ø¯Ù‚ÙŠÙ‚Ø©

**What happens:**
```
Every 15 minutes:
  â†’ System fetches confirmed bookings (routeId = null)
  â†’ Groups them by proximity + time
  â†’ Creates optimized routes
  â†’ Sends for admin approval (if enabled)
  â†’ Dispatches to drivers (if auto-approved)
```

**Manual Trigger:**
- Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ **"Trigger Now"** Ù„ØªØ´ØºÙŠÙ„ ÙÙˆØ±ÙŠ

---

### Scenario 2: Ø¥Ù†Ø´Ø§Ø¡ Route ÙŠØ¯ÙˆÙŠØ§Ù‹

**From Orders Page:**
1. Ø§ÙØªØ­ `/admin/orders`
2. Ø­Ø¯Ø¯ 2+ Ø­Ø¬ÙˆØ²Ø§Øª (âœ… checkboxes)
3. Ø§Ø¶ØºØ· **"Create Route"**
4. Route Preview Modal ÙŠÙØªØ­
5. Ø±Ø§Ø¬Ø¹:
   - Ø¹Ø¯Ø¯ Ø§Ù„ØªÙˆÙ‚ÙØ§Øª
   - Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø¯Ø±
   - Ø§Ù„Ù…Ø³Ø§ÙØ©
   - Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
6. Ø§Ø®ØªØ± Ø³Ø§Ø¦Ù‚ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
7. Ø§Ø¶ØºØ· **"Approve & Create"**

**Result:**
- Route ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡
- Bookings Ù…Ø±Ø¨ÙˆØ·Ø© Ø¨Ù€ routeId
- Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ù„Ø³Ø§Ø¦Ù‚ (Pusher + SMS + Push + Email)
- ØªØ¸Ù‡Ø± ÙÙŠ `/admin/routes`

---

### Scenario 3: Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ø¹ØªÙ…Ø§Ø¯ Routes

**From Routes Page:**
1. Ø§ÙØªØ­ `/admin/routes`
2. Ø³ØªØ¬Ø¯ routes Ø¨Ø­Ø§Ù„Ø© **"Pending Approval"**
3. Ø§Ø¶ØºØ· **"Review"** Ø¹Ù„Ù‰ Ø£ÙŠ route
4. Route Preview Modal ÙŠÙØªØ­
5. Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„
6. Ø§Ø®ØªØ±:
   - âœ… **Approve** â†’ ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù„Ù„Ø³Ø§Ø¦Ù‚ Ù…Ø¨Ø§Ø´Ø±Ø©
   - âŒ **Reject** â†’ ØªØ­Ø±ÙŠØ± Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª + ÙƒØªØ§Ø¨Ø© Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶

---

### Scenario 4: ØªØ¹Ø·ÙŠÙ„ Auto Mode (Emergency)

**If something goes wrong:**
1. Ø§ÙØªØ­ `/admin/dashboard`
2. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Toggle â†’ Ø³ÙŠØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ **MANUAL**
3. Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØªÙˆÙ‚Ù Ø¹Ù† Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙÙˆØ±Ø§Ù‹

**Alternative (API):**
```bash
curl -X PATCH https://speedy-van.co.uk/api/admin/routing/settings/mode \
  -H "Content-Type: application/json" \
  -d '{"mode": "manual"}'
```

---

## ğŸ“Š Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù†Ø¸Ø§Ù…

### Real-time Monitoring

**Admin Dashboard:**
- Current mode displayed
- Last run time
- Next scheduled run
- Recent history

**Logs Page:**
```
/admin/logs?type=auto_routing
```

### Database Queries

**Check auto-routing history:**
```sql
SELECT 
  "eventType",
  "details",
  "result",
  "timestamp"
FROM "SystemAuditLog"
WHERE "eventType" IN ('auto_routing_run', 'auto_routing_completed')
ORDER BY "timestamp" DESC
LIMIT 20;
```

**Check pending approvals:**
```sql
SELECT 
  ra.id,
  ra."routeId",
  ra."status",
  ra."totalDrops",
  ra."totalValue",
  ra."submittedAt",
  ra."autoGenerated"
FROM "RouteApproval" ra
WHERE ra."status" = 'pending'
ORDER BY ra."submittedAt" DESC;
```

**Check driver notifications:**
```sql
SELECT 
  "eventType",
  "targetId" as "routeId",
  "details",
  "timestamp"
FROM "SystemAuditLog"
WHERE "eventType" IN ('driver_notified', 'driver_notification_failed')
ORDER BY "timestamp" DESC
LIMIT 20;
```

---

## ğŸ”§ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©

### ØªØ®ØµÙŠØµ Auto-Routing Behavior

**Via API:**
```javascript
const response = await fetch('/api/admin/routing/settings', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    maxDropsPerRoute: 15, // Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„ØªÙˆÙ‚ÙØ§Øª
    maxRouteDistanceKm: 75, // Ø²ÙŠØ§Ø¯Ø© Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¨Ø­Ø«
    autoAssignDrivers: true, // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø³Ù†Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    requireAdminApproval: false, // Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (Ø®Ø·Ø±!)
    minDropsForAutoRoute: 3, // Ø­Ø¯ Ø£Ø¯Ù†Ù‰ Ø£Ø¹Ù„Ù‰
  })
});
```

**âš ï¸ Warning:**
- `requireAdminApproval: false` = routes ØªØ°Ù‡Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ø¨Ø¯ÙˆÙ† Ù…Ø±Ø§Ø¬Ø¹Ø©
- Ø§Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø· ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø£Ùˆ Ø¥Ø°Ø§ ÙƒÙ†Øª ÙˆØ§Ø«Ù‚Ø§Ù‹ 100% Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…

---

### ØªØ®ØµÙŠØµ Cron Interval

**Change from 15 to 10 minutes:**
```javascript
await fetch('/api/admin/routing/settings', {
  method: 'POST',
  body: JSON.stringify({
    autoRoutingIntervalMin: 10
  })
});
```

**Update `vercel.json`:**
```json
{
  "crons": [{
    "path": "/api/admin/routing/cron",
    "schedule": "*/10 * * * *"
  }]
}
```

---

## ğŸ› Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Problem: Auto-routing Ù„Ø§ ÙŠØ¹Ù…Ù„

**Check:**
```sql
SELECT * FROM "SystemSettings" LIMIT 1;
```

**Verify:**
- `autoRoutingEnabled = true`
- `routingMode = 'auto'`
- `lastAutoRoutingRun` ØªØ­Ø¯Ø« ÙƒÙ„ 15 Ø¯Ù‚ÙŠÙ‚Ø©

**Solution:**
1. Toggle mode manually from dashboard
2. Click "Trigger Now" to test
3. Check audit log for errors

---

### Problem: Routes Ù„Ø§ ØªØ¸Ù‡Ø± ÙÙŠ Admin

**Check:**
```sql
SELECT COUNT(*) FROM "Route" WHERE "createdAt" > NOW() - INTERVAL '24 hours';
SELECT COUNT(*) FROM "RouteApproval" WHERE "status" = 'pending';
```

**Solution:**
- Refresh the page
- Check filters (status, date range)
- Verify routes were actually created

---

### Problem: Driver Ù„Ù… ÙŠØ³ØªÙ„Ù… Ø¥Ø´Ø¹Ø§Ø±

**Check notification log:**
```sql
SELECT * FROM "SystemAuditLog"
WHERE "eventType" = 'driver_notification_failed'
ORDER BY "timestamp" DESC
LIMIT 10;
```

**Common Causes:**
- Driver phone number incorrect
- SMS API credentials expired
- Pusher connection issue
- Driver app not installed

**Solution:**
- Verify driver contact info
- Check API keys in .env
- Manually call driver as backup

---

## ğŸ“ API Examples (Copy-Paste Ready)

### 1. Get Current Config
```bash
curl https://speedy-van.co.uk/api/admin/routing/settings \
  -H "Cookie: YOUR_ADMIN_COOKIE"
```

### 2. Switch to Auto Mode
```bash
curl -X PATCH https://speedy-van.co.uk/api/admin/routing/settings/mode \
  -H "Content-Type: application/json" \
  -H "Cookie: YOUR_ADMIN_COOKIE" \
  -d '{"mode": "auto"}'
```

### 3. Trigger Auto-Routing Now
```bash
curl -X POST https://speedy-van.co.uk/api/admin/routing/trigger \
  -H "Cookie: YOUR_ADMIN_COOKIE"
```

### 4. Create Manual Route
```bash
curl -X POST https://speedy-van.co.uk/api/admin/routing/manual \
  -H "Content-Type: application/json" \
  -H "Cookie: YOUR_ADMIN_COOKIE" \
  -d '{
    "bookingIds": ["booking_id_1", "booking_id_2"],
    "driverId": "driver_id",
    "startTime": "2025-10-12T09:00:00Z"
  }'
```

### 5. Approve Route
```bash
curl -X POST https://speedy-van.co.uk/api/admin/routing/approve \
  -H "Content-Type: application/json" \
  -H "Cookie: YOUR_ADMIN_COOKIE" \
  -d '{
    "routeId": "route_xxx",
    "driverId": "driver_xxx"
  }'
```

### 6. Reject Route
```bash
curl -X DELETE https://speedy-van.co.uk/api/admin/routing/approve \
  -H "Content-Type: application/json" \
  -H "Cookie: YOUR_ADMIN_COOKIE" \
  -d '{
    "routeId": "route_xxx",
    "reason": "Route not optimized properly"
  }'
```

---

## ğŸ“ Best Practices

### 1. Start with Manual Mode
- ØªØ¹Ø±Ù‘Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹
- Ø±Ø§Ù‚Ø¨ ÙƒÙŠÙ ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ø±Ù‚
- Ø§ÙÙ‡Ù… Ø§Ù„Ø£Ù†Ù…Ø§Ø·

### 2. Test Auto Mode in Staging
- Ø¬Ø±Ù‘Ø¨ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù‚Ù„ÙŠÙ„Ø© Ø£ÙˆÙ„Ø§Ù‹
- Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
- Ø§Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©

### 3. Always Use Approval Mode Initially
- `requireAdminApproval: true`
- Ø±Ø§Ø¬Ø¹ ÙƒÙ„ route Ù‚Ø¨Ù„ Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§
- Ø§ÙƒØªØ³Ø¨ Ø«Ù‚Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…

### 4. Monitor Regularly
- Ø§ÙØªØ­ Dashboard ÙŠÙˆÙ…ÙŠØ§Ù‹
- Ø±Ø§Ø¬Ø¹ audit logs Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹
- ØªØ§Ø¨Ø¹ metrics Ø´Ù‡Ø±ÙŠØ§Ù‹

### 5. Gather Feedback
- Ø§Ø³ØªÙ…Ø¹ Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†
- Ø±Ø§Ù‚Ø¨ customer satisfaction
- Ø§Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±

---

## ğŸ“ˆ Metrics to Track

**Daily:**
- Routes created (auto vs manual)
- Approval rate (approved vs rejected)
- Average bookings per route
- Driver notification success rate

**Weekly:**
- Route optimization efficiency
- Time saved vs manual creation
- Admin approval time
- Driver feedback scores

**Monthly:**
- Cost savings from optimization
- System uptime
- Error rate
- Performance trends

---

## ğŸ‰ Success Stories (Use Cases)

### Use Case 1: Busy Morning Rush
**Scenario:** 20 bookings between 8-10 AM in Glasgow

**Auto Mode:**
- System groups into 3 optimized routes
- Routes created in < 10 seconds
- Drivers notified immediately
- Admin reviews and approves in 2 minutes
- Total time: **12 minutes**

**Manual Mode (old way):**
- Admin manually reviews 20 bookings
- Manually groups by area
- Creates 3 routes individually
- Assigns drivers one by one
- Total time: **45+ minutes**

**Time Saved: 33 minutes** âš¡

---

### Use Case 2: Late Evening Scattered Orders
**Scenario:** 5 bookings across wide area

**Auto Mode:**
- System creates 2-3 routes based on proximity
- Optimizes for minimal driving distance
- Admin can review and merge if needed

**Benefit:** No manual calculation required

---

### Use Case 3: Emergency Rush Order
**Scenario:** Urgent booking needs immediate assignment

**Manual Mode:**
1. Select urgent booking + nearby bookings
2. Preview route
3. Assign best available driver
4. Skip approval â†’ immediate dispatch

**Total time: < 2 minutes** ğŸš€

---

## ğŸ”” Notification Channels Explained

### 1. Pusher (Real-time)
- **When:** Immediately on route assignment
- **Where:** Driver App (if open)
- **Contains:** Route ID, total stops, start time
- **Latency:** < 1 second

### 2. SMS
- **When:** Immediately after Pusher
- **Where:** Driver's phone number
- **Contains:** Summary + app reminder
- **Latency:** 1-3 seconds

### 3. Push Notification (Expo)
- **When:** Immediately after SMS
- **Where:** iOS/Android device (if app installed)
- **Contains:** Route summary + badge count
- **Latency:** 2-5 seconds

### 4. Email (Backup)
- **When:** Last fallback
- **Where:** Driver's email
- **Contains:** Full route details HTML
- **Latency:** 5-10 seconds

**All channels work independently** - if one fails, others still work.

---

## ğŸ® Live Demo Scenarios

### Demo 1: Auto-Routing in Action

```bash
# 1. Enable Auto Mode
curl -X PATCH http://localhost:3000/api/admin/routing/settings/mode \
  -H "Content-Type: application/json" \
  -d '{"mode": "auto"}'

# 2. Create test bookings (use booking UI or API)

# 3. Trigger routing manually (don't wait for cron)
curl -X POST http://localhost:3000/api/admin/routing/trigger \
  -H "Cookie: YOUR_ADMIN_COOKIE"

# 4. Check results
curl http://localhost:3000/api/admin/routes
```

---

### Demo 2: Manual Route with Preview

```bash
# 1. Get booking IDs
curl http://localhost:3000/api/admin/orders?status=CONFIRMED

# 2. Preview route
curl -X PUT http://localhost:3000/api/admin/routing/manual/preview \
  -H "Content-Type: application/json" \
  -d '{"bookingIds": ["id1", "id2", "id3"]}'

# 3. Create route
curl -X POST http://localhost:3000/api/admin/routing/manual \
  -H "Content-Type: application/json" \
  -d '{
    "bookingIds": ["id1", "id2", "id3"],
    "startTime": "2025-10-12T09:00:00Z",
    "driverId": "driver_id"
  }'
```

---

### Demo 3: Approval Workflow

```bash
# 1. Get pending approvals
curl http://localhost:3000/api/admin/routing/approve

# 2. Approve a route
curl -X POST http://localhost:3000/api/admin/routing/approve \
  -H "Content-Type: application/json" \
  -d '{
    "routeId": "route_xxx",
    "driverId": "driver_xxx"
  }'

# OR reject it
curl -X DELETE http://localhost:3000/api/admin/routing/approve \
  -H "Content-Type: application/json" \
  -d '{
    "routeId": "route_xxx",
    "reason": "Not optimal for this driver"
  }'
```

---

## ğŸ“± Driver App Integration

**What Driver Sees:**

1. **Real-time Notification (Pusher):**
   ```
   ğŸ”” New Route Assigned
   ğŸ“¦ 5 stops starting at 9:00 AM
   Tap to view details
   ```

2. **SMS:**
   ```
   Hi John, you have been assigned a new route 
   with 5 stops starting at 09:00. Please check 
   your app for details. - Speedy Van
   ```

3. **Push Notification:**
   ```
   ğŸšš New Route Assigned
   5 stops starting at 09:00
   [Badge: 1]
   ```

4. **Email:**
   ```
   Subject: New Route Assigned - 5 Stops
   
   Hi John,
   You have been assigned a new delivery route:
   - Route ID: route_xxx
   - Total Stops: 5
   - Start Time: 12 Oct 2025, 09:00
   - Estimated Duration: 180 minutes
   
   Please open your app to view details.
   ```

**Driver App must:**
- Listen to Pusher channel: `driver-{driverId}`
- Handle event: `new-route-assigned`
- Fetch route details: `GET /api/driver/routes/{routeId}`
- Update UI immediately

---

## âš¡ Pro Tips

### Tip 1: Optimize for Peak Hours
```javascript
// Set tighter clustering during rush hours
{
  "maxRouteDistanceKm": 30, // Smaller radius
  "maxDropsPerRoute": 8, // Fewer stops
}
```

### Tip 2: Weekend Relaxed Mode
```javascript
// Allow larger routes on weekends
{
  "maxRouteDistanceKm": 75,
  "maxDropsPerRoute": 12,
}
```

### Tip 3: Approval Bypass for Trusted Scenarios
```javascript
// Skip approval for small, simple routes
if (totalDrops <= 3 && totalDistance < 20) {
  skipApproval = true;
}
```

### Tip 4: Monitor and Adjust
- Review metrics weekly
- Adjust thresholds based on actual performance
- Listen to driver feedback

---

## ğŸ¯ Key Performance Indicators

**Track these daily:**
- âœ… Auto-routing success rate: > 90%
- âœ… Average route creation time: < 5s
- âœ… Notification delivery rate: > 95%
- âœ… Admin approval time: < 5 min
- âœ… Driver acceptance rate: > 85%

**Red flags:**
- âŒ Many rejected routes (> 20%)
- âŒ Long approval times (> 30 min)
- âŒ Frequent errors in logs
- âŒ Driver complaints about routes

---

## ğŸ“ Need Help?

**Documentation:**
- Full implementation: `DUAL_ROUTING_SYSTEM_IMPLEMENTATION.md`
- Testing guide: `TESTING_GUIDE.md`
- Deployment checklist: `DEPLOYMENT_CHECKLIST.md`

**Support:**
- Email: support@speedy-van.co.uk
- Phone: 07901846297

**Developer Support:**
- Check `SystemAuditLog` for detailed errors
- Review code in `apps/web/src/lib/orchestration/RouteManager.ts`
- Monitor Vercel logs for cron job execution

---

## âœ… Summary

**Ù†Ø¸Ø§Ù… ÙƒØ§Ù…Ù„ ÙˆÙ…ØªÙƒØ§Ù…Ù„:**
- âš¡ Auto mode Ù„Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
- ğŸ–ï¸ Manual mode Ù„Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„
- âœ… Approval system Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
- ğŸ“Š Full audit trail Ù„Ù„ØªØªØ¨Ø¹
- ğŸ”” Multi-channel notifications
- ğŸ›¡ï¸ Safety rules and validation
- ğŸ“ˆ Performance monitoring

**Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² ÙˆÙ‚ÙˆÙŠ! ğŸ’ª**

**Happy Routing! ğŸš€**

