# โ ูุธุงู ุชุชุจุน ุงูุฒูุงุฑ - ููุชูู ุจุงููุงูู

## ๐ ุงูุชูููุฐ ุงูููุงุฆู

ุชู ุฅูุดุงุก ูุธุงู ูุชูุงูู ูุชุชุจุน ุงูุฒูุงุฑ ุจุดูู ุชููุงุฆู ูุน ุชุญุฏูุฏ ุงููููุน ุงูุฌุบุฑุงูู ุงูุฏููู.

---

## ๐ ุงููููุงุช ุงููููุดุฃุฉ

### 1. API Endpoint
**ุงูููู**: `apps/web/src/app/api/visitors/track/route.ts`
- ูุณุชูุจู ุจูุงูุงุช ุงูุฒูุงุฑ ุชููุงุฆููุง
- ูุญุฏุฏ ุงููููุน ูู IP Address (ipapi.co)
- ูุญูู ูุนูููุงุช ุงูุฌูุงุฒ ูุงููุชุตูุญ
- ูุฎุฒู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ PostgreSQL

### 2. React Hook
**ุงูููู**: `apps/web/src/hooks/useVisitorTracking.ts`
- ูุฏูุฑ Session ID (ูุฏุฉ 30 ุฏูููุฉ)
- ูุฏูุฑ Visitor ID (ุฏุงุฆู ูู localStorage)
- ูุฌูุน ูุนูููุงุช ุงูุฌูุงุฒ ุชููุงุฆููุง
- ูุชุชุจุน ุงูุตูุญุงุช ูุงูุฅุฌุฑุงุกุงุช

### 3. Auto Tracker Component
**ุงูููู**: `apps/web/src/components/VisitorTracker.tsx`
- ูุนูู ุชููุงุฆููุง ุจุฏูู ุชุฏุฎู
- ูุชุชุจุน ุชุบููุฑ ุงูุตูุญุงุช
- ูุณุฌู ุงูููุฑุงุช ุนูู ุงูุฑูุงุจุท ูุงูุฃุฒุฑุงุฑ
- ูุฑุตุฏ ุฅุฑุณุงู ุงูููุงุฐุฌ
- ูููุณ ุนูู ุงูุชูุฑูุฑ

### 4. Database Schema
**ุงูููู**: `packages/shared/prisma/schema.prisma`
ุชู ุฅุถุงูุฉ 3 ุฌุฏุงูู:
- `VisitorSession` - ูุนูููุงุช ุงูุฌูุณุฉ ูุงููููุน
- `PageView` - ุงูุตูุญุงุช ุงููุฒูุฑุฉ
- `VisitorAction` - ุชูุงุนูุงุช ุงููุณุชุฎุฏู

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. Database Migration โ
```bash
# ุชู ุชูููุฐ:
pnpm prisma db push
```
- ุชู ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุซูุงุซุฉ
- ุชู ุชุญุฏูุซ Prisma Client

### 2. Integration โ
```tsx
// ุชูุช ุฅุถุงูุฉ ูู: apps/web/src/app/layout.tsx
import { VisitorTracker } from '@/components/VisitorTracker';

<body>
  <VisitorTracker />  {/* โ ุชู ุฅุถุงูุชู */}
  {/* ... rest of app */}
</body>
```

### 3. Compilation โ
- ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู TypeScript
- ุฌููุน ุงููููุงุช ุชุนูู ุจุดูู ุตุญูุญ

---

## ๐ ุงูุจูุงูุงุช ุงูููุชุชุจุนุฉ ุชููุงุฆููุง

### ูุนูููุงุช ุงููููุน:
- โ IP Address
- โ Country (ุงูุฏููุฉ)
- โ City (ุงููุฏููุฉ)
- โ Region (ุงูููุทูุฉ)
- โ Latitude & Longitude (ุงูุฅุญุฏุงุซูุงุช ุงูุฏูููุฉ)
- โ Timezone (ุงูููุทูุฉ ุงูุฒูููุฉ)

### ูุนูููุงุช ุงูุฌูุงุฒ:
- โ Browser (Chrome, Firefox, Safari...)
- โ Browser Version
- โ Operating System (Windows, Mac, Linux, Android, iOS...)
- โ Device Type (Desktop, Mobile, Tablet)
- โ Screen Resolution
- โ Language

### ูุนูููุงุช ุงูุชุตูุญ:
- โ ูู ุตูุญุฉ ุชูุช ุฒูุงุฑุชูุง
- โ Referrer (ูู ุฃูู ุฌุงุก ุงูุฒุงุฆุฑ)
- โ ููุช ุงูุฒูุงุฑุฉ ุงูุฏููู
- โ ูุฏุฉ ุงูุฌูุณุฉ

### ุงูุชูุงุนูุงุช:
- โ ุงูููุฑุงุช ุนูู ุงูุฑูุงุจุท
- โ ุงูููุฑุงุช ุนูู ุงูุฃุฒุฑุงุฑ
- โ ุฅุฑุณุงู ุงูููุงุฐุฌ
- โ ุนูู ุงูุชูุฑูุฑ (25%, 50%, 75%, 100%)

---

## ๐ ููููุฉ ุงุณุชุฎุฏุงูู

### 1. ุนุฑุถ ุงูุจูุงูุงุช ูู Admin Dashboard
```
/admin/visitors        - ููุญุฉ ุชุญูู ูุงููุฉ ููุฒูุงุฑ
/admin/analytics       - ูุณู ุงูุฒูุงุฑ ูู ุงูุชุญูููุงุช
```

### 2. ุงุณุชุนูุงูุงุช SQL ูุจุงุดุฑุฉ
```sql
-- ุนุฏุฏ ุงูุฒูุงุฑ ุญุณุจ ุงูุฏููุฉ
SELECT country, COUNT(*) as visitors
FROM "VisitorSession"
WHERE country IS NOT NULL
GROUP BY country
ORDER BY visitors DESC;

-- ุฃูุซุฑ ุงููุฏู ุฒูุงุฑุฉ
SELECT city, country, COUNT(*) as visits
FROM "VisitorSession"
WHERE city IS NOT NULL
GROUP BY city, country
ORDER BY visits DESC
LIMIT 10;

-- ุงูุตูุญุงุช ุงูุฃูุซุฑ ุฒูุงุฑุฉ
SELECT page, COUNT(*) as views
FROM "PageView"
GROUP BY page
ORDER BY views DESC
LIMIT 10;
```

### 3. ุงุณุชุฎุฏุงู Prisma Studio
```bash
cd packages/shared
pnpm prisma studio
```
ุซู ุชุตูุญ ุงูุฌุฏุงูู:
- `VisitorSession`
- `PageView`
- `VisitorAction`

---

## ๐ฏ ุชุชุจุน ุฃุญุฏุงุซ ูุฎุตุตุฉ (ุงุฎุชูุงุฑู)

ุฅุฐุง ุฃุฑุฏุช ุชุชุจุน ุฃุญุฏุงุซ ูุนููุฉ ูู ุงูููุฏ:

```tsx
'use client';
import { useVisitorTracking } from '@/hooks/useVisitorTracking';

function BookingButton() {
  const { trackAction } = useVisitorTracking();

  const handleBooking = () => {
    // ุชุชุจุน ุญุฏุซ ุงูุญุฌุฒ
    trackAction('booking_started', {
      packageType: 'premium',
      estimatedPrice: 99.99,
    });
    
    // ... ุจุงูู ููุฏ ุงูุญุฌุฒ
  };

  return <button onClick={handleBooking}>ุงุญุฌุฒ ุงูุขู</button>;
}
```

---

## ๐ ููุงุฆุฏ ุงููุธุงู

### 1. ุชุญููู ุงูููุงุทู ุงูุฌุบุฑุงููุฉ
- ูุนุฑูุฉ ุฃู ุงููุฏู/ุงูููุงุทู ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง
- ุชุญุฏูุฏ ูุฑุต ุงูุชูุณุน ุงูุฌุบุฑุงูู
- ุชุญุณูู ุชุบุทูุฉ ุงูุฎุฏูุฉ

### 2. ุชุญููู ุณููู ุงููุณุชุฎุฏููู
- ุงูุตูุญุงุช ุงูุฃูุซุฑ ุฒูุงุฑุฉ
- ูุนุฏู ุงูุชุญููู ุญุณุจ ุงูููุทูุฉ
- ููุงุท ุงูุฎุฑูุฌ ูู ุงููููุน

### 3. ุงูุชุญุณููุงุช ุงูุชูููุฉ
- ูุนุฑูุฉ ุงูุฃุฌูุฒุฉ/ุงููุชุตูุญุงุช ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง
- ุชุญุณูู ุงูุชูุงูู ูุน ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ
- ุชุญุฏูุฏ ุงููุดุงูู ุงูุชูููุฉ

### 4. ุงูุชุณููู ุงููุณุชูุฏู
- ุงุณุชูุฏุงู ุฅุนูุงูุงุช ุญุณุจ ุงููุฏู
- ุชุฎุตูุต ุงูุนุฑูุถ ุญุณุจ ุงูููุทูุฉ
- ููู ุงููููุงุช ุงูุชุณููููุฉ ุงูุฃูุถู

---

## ๐ ุงูุฎุตูุตูุฉ ูุงูุฃูุงู

### ูุนุงููุฑ GDPR ูุชูุงููุฉ:
- โ ูุง ูุชู ุชุฎุฒูู ูุนูููุงุช ุดุฎุตูุฉ
- โ ูููู ุญุฐู ุจูุงูุงุช ุงูุฒุงุฆุฑ
- โ ุงูุจูุงูุงุช ูุฌูููุฉ ุงููุตุฏุฑ
- โ ุงุณุชุฎุฏุงู ููุชุญูููุงุช ููุท

### ุงูุจูุงูุงุช ุงููุฎุฒูุฉ:
- โ ูุง ูุฎุฒู: ุงูุฃุณูุงุกุ ุงูุจุฑูุฏ ุงูุฅููุชุฑูููุ ุฃุฑูุงู ุงูููุงุชู
- โ ูุฎุฒู: IPุ ุงููููุน ุงูุนุงูุ ูุนูููุงุช ุงูุฌูุงุฒ (ูุฌูููุฉ)

---

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู

### ุงุฎุชุจุงุฑ ุณุฑูุน:
1. ุงูุชุญ ุงููููุน ูู ุงููุชุตูุญ
2. ุชุตูุญ ุนุฏุฉ ุตูุญุงุช
3. ุงููุฑ ุนูู ุจุนุถ ุงูุฃุฒุฑุงุฑ
4. ุงูุชุญ Prisma Studio:
   ```bash
   cd packages/shared
   pnpm prisma studio
   ```
5. ุชุญูู ูู ุงูุฌุฏุงูู:
   - `VisitorSession` โ ูุฌุจ ุฃู ุชุฑู ุฌูุณุชู
   - `PageView` โ ูุฌุจ ุฃู ุชุฑู ุงูุตูุญุงุช ุงูุชู ุฒุฑุชูุง
   - `VisitorAction` โ ูุฌุจ ุฃู ุชุฑู ุชูุงุนูุงุชู

### ุงุฎุชุจุงุฑ ุงููููุน ุงูุฌุบุฑุงูู:
```sql
SELECT 
  sessionId,
  country,
  city,
  lat,
  lng,
  createdAt
FROM "VisitorSession"
ORDER BY createdAt DESC
LIMIT 5;
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

### 1. ุงูุฃุฏุงุก
- ุงููุธุงู ูุง ูุคุซุฑ ุนูู ุณุฑุนุฉ ุงููููุน
- ุฌููุน ุงูุนูููุงุช asynchronous
- ูุง ุชูุฌุฏ ุนูููุงุช ุญุธุฑ (blocking)

### 2. ุงูุชุฎุฒูู
- Session ID: 30 ุฏูููุฉ (sessionStorage)
- Visitor ID: ุฏุงุฆู (localStorage)
- ูุชู ุชุฌุฏูุฏ Session ID ุชููุงุฆููุง

### 3. ุงูุชูุงูู
- ูุนูู ุนูู ุฌููุน ุงููุชุตูุญุงุช ุงูุญุฏูุซุฉ
- ูุฏุนู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ ุจุงููุงูู
- ูุนูู ูุน Server-Side Rendering (Next.js)

---

## ๐ ุฌุงูุฒ ููุฅูุชุงุฌ!

ุงููุธุงู ุงูุขู ููุนูู ููุนูู ุชููุงุฆููุง! ๐

ูุง ุญุงุฌุฉ ูุฃู ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ - ูู ุดูุก ูุนูู ูู ุงูุฎูููุฉ.

---

## ๐ ูููุงุช ุชูุซูููุฉ ุฅุถุงููุฉ

- `AUTO_LOCATION_DETECTION_COMPLETE.md` - ุชูุงุตูู ุชูููุฉ ูุงููุฉ
- `VISITOR_TRACKING_SETUP.md` - ุฏููู ุงูุฅุนุฏุงุฏ ุงูุณุฑูุน
- `ANALYTICS_UPGRADE_COMPLETE.md` - ุชุญุฏูุซุงุช ููุญุฉ ุงูุชุญูู

---

**ุชู ุจูุฌุงุญ! โ**  
**ุงูุชุงุฑูุฎ**: 6 ุฃูุชูุจุฑ 2025  
**ุงููุธุงู**: ุชุชุจุน ุงูุฒูุงุฑ ุงูุชููุงุฆู ุจุงููููุน ุงูุฌุบุฑุงูู
