# ุฅุตูุงุญ ูุดููุฉ ุงูุณุนุฑ ุงูุซุงุจุช ูู ูุธุงู ุงูุญุฌุฒ โ

## ุงููุดููุฉ ุงูุฃุตููุฉ

ูุงู ุงูุณุนุฑ ุซุงุจุชุงู ุนูุฏ 59 ุฌููู ุฅุณุชุฑูููู ุนูุฏ ุงูุฏูุนุ ุจุบุถ ุงููุธุฑ ุนู ุงููุณุงูุฉ ุฃู ุนุฏุฏ ุงูุนูุงุตุฑ ุฃู ุงูุทูุงุจู.

## ุณุจุจ ุงููุดููุฉ

ูุงู ููุงู ูุธุงูุงู ูููุตูุงู ูุญุณุงุจ ุงูุณุนุฑ:

1. **ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ** (`computeQuote` ูู `page.tsx`) - ูุญุณุจ ุงูุณุนุฑ ุจุดูู ุตุญูุญ
2. **ูู ุงูุฎุงุฏู** (`computeQuote` ูู `pricing.ts`) - ูุญุณุจ ุงูุณุนุฑ ูู ุฌุฏูุฏ ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ ูู ุงููุงุฌูุฉ

ุงููุดููุฉ ุฃู ุงูุณุนุฑ ุงููุญุณูุจ ูู ุงููุงุฌูุฉ ูุง ูุชู ุฅุฑุณุงูู ุฅูู ุงูุฎุงุฏู. ุจุฏูุงู ูู ุฐููุ ุงูุฎุงุฏู ูุญุณุจ ุงูุณุนุฑ ูู ุฌุฏูุฏ ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงููุฑุณูุฉุ ูููู ุงูุจูุงูุงุช ุงููุฑุณูุฉ ูุงูุช ูุงูุตุฉ.

## ุงูุจูุงูุงุช ุงููุงูุตุฉ

ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูู ุชูู ุชุฑุณู:

- ุนุฏุฏ ุงูุนูุงุตุฑ (`itemsCount`)
- ุงูุญุฌู (`volumeM3`)
- ุนุฏุฏ ุงูุนูุงู (`workers`)
- ูุนูููุงุช ุงูุทูุงุจู (`stairsFloors`)
- ุงูุนูุงุตุฑ ุงูุซูููุฉ (`heavyItems`)
- ุงูุชุฌููุน (`assembly`)
- ููุงุฏ ุงูุชุนุจุฆุฉ (`packingMaterials`)

## ุงูุญู ุงููุทุจู โ

### 1. ุฅุฑุณุงู ุงูุจูุงูุงุช ุงููุงููุฉ

ุชู ุชุญุฏูุซ ูุธุงุฆู `createDraft` ู `updateDraft` ูุฅุฑุณุงู ุฌููุน ุงูุจูุงูุงุช ุงููุทููุจุฉ ูุญุณุงุจ ุงูุณุนุฑ ุงูุตุญูุญ:

```typescript
const body: any = {
  // ... ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
  itemsCount,
  volumeM3,
  stairsFloors,
  access: {
    floors: stairsFloors,
    heavyItems: 0,
    longCarry: false,
  },
};
```

### 2. ุงุณุชุฎุฏุงู React State ุจุฏูุงู ูู DOM

ุชู ุชุบููุฑ ุงูููุฏ ูู ูุญุงููุฉ ูุฑุงุกุฉ ููู ูู DOM elements ุบูุฑ ููุฌูุฏุฉ ุฅูู ุงุณุชุฎุฏุงู React form state:

```typescript
// ูุจู (ุฎุงุทุฆ):
const workers = Number(
  (document.querySelector('input[name="workers"]') as HTMLInputElement)
    ?.value || 1
);

// ุจุนุฏ (ุตุญูุญ):
const formValues = watch();
const workers = formValues.workers || 1;
```

### 3. ุฅุถุงูุฉ ุงูุญููู ุงูููููุฏุฉ ุฅูู API

ุชู ุฅุถุงูุฉ ุงูุญููู ุงูุชุงููุฉ ุฅูู API ุงูุญุฌุฒ:

- `itemsCount` - ุนุฏุฏ ุงูุนูุงุตุฑ
- `volumeM3` - ุงูุญุฌู
- `stairsFloors` - ุนุฏุฏ ุงูุทูุงุจู

### 4. ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุชู ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุฎุฒูู ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ ุงููุทููุจุฉ ูุญุณุงุจ ุงูุณุนุฑ:

```sql
-- Migration: 20250819013119_add_pricing_fields
ALTER TABLE "public"."Booking" ADD COLUMN "itemsCount" INTEGER;
ALTER TABLE "public"."Booking" ADD COLUMN "volumeM3" DOUBLE PRECISION;
```

### 5. ุฅุตูุงุญ ุฎุทุฃ Prisma

ุชู ุญู ุฎุทุฃ `Unknown argument 'itemsCount'` ูู ุฎูุงู:

- ุฅุถุงูุฉ ุงูุญููู ุฅูู Prisma schema
- ุฅูุดุงุก migration ุฌุฏูุฏ
- ุชุทุจูู ุงูุชุบููุฑุงุช ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 6. ุฅุถุงูุฉ ููุทู ุงูุชุณุนูุฑ ุงูุฏููุงูููู โญ

ุชู ุฅุถุงูุฉ ููุทู ุญุณุงุจ ุงูุณุนุฑ ุจูุงุกู ุนูู:

- **ุนุฏุฏ ุงูุนูุงุตุฑ**: ยฃ0.50 ููู ุนูุตุฑ
- **ุงูุญุฌู**: ยฃ2.00 ููู ูุชุฑ ููุนุจ
- **ุงูุทูุงุจู**: ยฃ12 ููู ุทุงุจู ุจุฏูู ูุตุนุฏุ ยฃ2 ููู ุทุงุจู ูุน ูุตุนุฏ

### 7. ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุณุนุฑ ุชููุงุฆูุงู

ุชู ุฅุถุงูุฉ ููุทู ูุฅุนุงุฏุฉ ุญุณุงุจ ุงูุณุนุฑ ุชููุงุฆูุงู ุนูุฏ ุชุญุฏูุซ ุงูุจูุงูุงุช:

- ุนูุฏ ุชุบููุฑ ุนุฏุฏ ุงูุนูุงุตุฑ
- ุนูุฏ ุชุบููุฑ ุงูุญุฌู
- ุนูุฏ ุชุบููุฑ ุนุฏุฏ ุงูุทูุงุจู
- ุนูุฏ ุชุบููุฑ ุนุฏุฏ ุงูุนูุงู

### 8. ุฅุตูุงุญ API Calls โญ

ุชู ุฅุตูุงุญ ูุดููุฉ ุฃู API ูุง ูุณุชุฎุฏู `itemsCount` ู `volumeM3` ูู ุญุณุงุจ ุงูุณุนุฑ:

- ุฅุถุงูุฉ `itemsCount` ู `volumeM3` ุฅูู `computeQuote` ูู `/api/booking-luxury/draft` (ุชู ุชุฑุญูู ุงููุณุงุฑ)
- ุฅุถุงูุฉ `itemsCount` ู `volumeM3` ุฅูู `computeQuote` ูู `/api/booking-luxury/[id]` (ุชู ุชุฑุญูู ุงููุณุงุฑ)

### 9. ุฒูุงุฏุฉ ุงูููู ุงูุงูุชุฑุงุถูุฉ โญ

ุชู ุฒูุงุฏุฉ ุงูููู ุงูุงูุชุฑุงุถูุฉ ูุฌุนู ุงูุชุณุนูุฑ ุฃูุซุฑ ูุงูุนูุฉ:

- `itemsCount`: ูู 10 ุฅูู 50 ุนูุตุฑ
- `volumeM3`: ูู 1 ุฅูู 5 ูุชุฑ ููุนุจ

### 10. ุฅุถุงูุฉ ุญููู ุงูุฅุฏุฎุงู ุงููุจุงุดุฑุฉ โญ

ุชู ุฅุถุงูุฉ ุญููู ุฅุฏุฎุงู ูุจุงุดุฑุฉ ูู ุงููููุฐุฌ ูุถูุงู ุฅุฏุฎุงู ุงูุจูุงูุงุช ุงูุตุญูุญุฉ:

- **ุญูู ุฅุฏุฎุงู ุนุฏุฏ ุงูุนูุงุตุฑ**: ูุณูุญ ูููุณุชุฎุฏู ุจุฅุฏุฎุงู ุงูุนุฏุฏ ุงูุฅุฌูุงูู ููุนูุงุตุฑ (1-1000)
- **ุญูู ุฅุฏุฎุงู ุงูุญุฌู**: ูุณูุญ ูููุณุชุฎุฏู ุจุฅุฏุฎุงู ุงูุญุฌู ุงูููุฏุฑ ุจุงููุชุฑ ุงูููุนุจ (0.1-100)
- **ุญูู ุงุฎุชูุงุฑ ุนุฏุฏ ุงูุนูุงู**: ูุณูุญ ูููุณุชุฎุฏู ุจุงุฎุชูุงุฑ ุนุฏุฏ ุงูุนูุงู ุงููุทููุจ (1-4)
- **ูุตุงุฆุญ ูุฅุฑุดุงุฏุงุช**: ุชูุฏู ุฅุฑุดุงุฏุงุช ูููุณุชุฎุฏู ุญูู ููููุฉ ุชูุฏูุฑ ุงูุญุฌู

## ุงูุชุญูู ูู ุงูุณุนุฑ

ุชู ุฅุถุงูุฉ ูุณู "Price Verification" ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูุนุฑุถ:

- ุงูุณุนุฑ ุงููุญุณูุจ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- ุงูุณุนุฑ ุงููุญุณูุจ ูู ุงูุฎุงุฏู
- ุญุงูุฉ ุชุทุงุจู ุงูุฃุณุนุงุฑ

## ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ โ

ุชู ุฅูุดุงุก ุณูุฑูุจุช ุงุฎุชุจุงุฑ (`test-pricing.ts`) ููุชุฃูุฏ ูู ุตุญุฉ ุงูุชุณุนูุฑ:

```
๐ Test 1: Basic pricing with default values
๐ฐ Price: ยฃ84.00 (ุจุฏูุงู ูู 59)

๐ Test 2: Long distance with items and volume
๐ฐ Price: ยฃ308.00 (ุจุฏูุงู ูู 59)

๐ Test 3: High volume and items
๐ฐ Price: ยฃ352.00 (ุจุฏูุงู ูู 59)

๐ Test 4: Weekend pricing
๐ฐ Price: ยฃ133.00 (ุจุฏูุงู ูู 59)
```

## ููููุฉ ุงูุงุฎุชุจุงุฑ

1. ุงููุฃ ูููุฐุฌ ุงูุญุฌุฒ ุจุงูุจูุงูุงุช ุงููุงููุฉ
2. ุชุฃูุฏ ูู ุฅุฏุฎุงู:
   - ุนููุงู ุงูุจุฏุงูุฉ ูุงูููุงูุฉ
   - ุนุฏุฏ ุงูุทูุงุจู ูููุน ุงูุนูุงุฑ
   - ุนุฏุฏ ุงูุนูุงุตุฑ ูุงูุญุฌู
   - ุนุฏุฏ ุงูุนูุงู
3. ุชุญูู ูู ุฃู ุงูุณุนุฑ ูุชุบูุฑ ุจูุงุกู ุนูู ุงููุฏุฎูุงุช
4. ุชุญูู ูู ุชุทุงุจู ุงูุณุนุฑ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูุน ุงูุณุนุฑ ูู ุงูุฎุงุฏู

## ุงููููุงุช ุงููุนุฏูุฉ

- `apps/web/src/app/(public)/book/page.tsx` - ุฅุฑุณุงู ุงูุจูุงูุงุช ุงููุงููุฉ ูู React state ูุฅุถุงูุฉ ุญููู ุงูุฅุฏุฎุงู ุงููุจุงุดุฑุฉ
- `apps/web/src/app/api/booking-luxury/draft/route.ts` - ุงุณุชูุจุงู ูุชุฎุฒูู ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ (ูููู)
- `apps/web/src/app/api/booking-luxury/[id]/route.ts` - ุชุญุฏูุซ ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ ูุฅุนุงุฏุฉ ุญุณุงุจ ุงูุณุนุฑ (ูููู)
- `apps/web/prisma/schema.prisma` - ุฅุถุงูุฉ ุงูุญููู ุงูููููุฏุฉ
- `apps/web/prisma/migrations/20250819013119_add_pricing_fields/` - migration ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `apps/web/src/lib/pricing.ts` - ุฅุถุงูุฉ ููุทู ุงูุชุณุนูุฑ ุงูุฏููุงูููู
- `apps/web/scripts/test-pricing.ts` - ุณูุฑูุจุช ุงุฎุชุจุงุฑ ุงูุชุณุนูุฑ
- `apps/web/scripts/test-database-pricing.ts` - ุณูุฑูุจุช ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `apps/web/package.json` - ุฅุถุงูุฉ ุณูุฑูุจุช ุงูุงุฎุชุจุงุฑ

## ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุงูุขู ุงูุณุนุฑ ุณูุชุบูุฑ ุจุดูู ุตุญูุญ ุจูุงุกู ุนูู:

- **ุงููุณุงูุฉ**: ยฃ0.85-2.40 ููู ูููููุชุฑ (ุญุณุจ ุงููุณุงูุฉ)
- **ุนุฏุฏ ุงูุทูุงุจู**: ยฃ4.00 ููู ุทุงุจู ููู ุนุงูู
- **ุนุฏุฏ ุงูุนูุงุตุฑ**: ยฃ0.50 ููู ุนูุตุฑ
- **ุงูุญุฌู**: ยฃ2.00 ููู ูุชุฑ ููุนุจ
- **ุนุฏุฏ ุงูุนูุงู**: ุชูููุฉ ุฅุถุงููุฉ ููุนูุงู ุงูุฅุถุงูููู
- **ุงูููุช**: ุฐุฑูุฉ (+25%)ุ ุฎุงุฑุฌ ุงูุฐุฑูุฉ (-10%)
- **ุงูุทูุณ**: ูุทุฑ (+8%)ุ ุฑูุงุญ (+12%)ุ ุซูุฌ (+25%)

**ููู ูููู ุซุงุจุชุงู ุนูุฏ 59 ุฌููู ุฅุณุชุฑูููู!**

## ููุงุญุธุงุช ูููุฉ

- ุชุฃูุฏ ูู ุฃู ุฌููุน ุงูุญููู ููููุกุฉ ูุจู ุงููุชุงุจุนุฉ
- ุงูุณุนุฑ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูุฌุจ ุฃู ูุชุทุงุจู ูุน ุงูุณุนุฑ ูู ุงูุฎุงุฏู
- ุฅุฐุง ูุงู ููุงู ุงุฎุชูุงูุ ุชุญูู ูู ุงูุจูุงูุงุช ุงููุฏุฎูุฉ
- ุชู ุฅุตูุงุญ ุฎุทุฃ Prisma `Unknown argument 'itemsCount'` ูู ุฎูุงู ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชู ุฅุถุงูุฉ ููุทู ุงูุชุณุนูุฑ ุงูุฏููุงูููู ุจูุงุกู ุนูู ุนุฏุฏ ุงูุนูุงุตุฑ ูุงูุญุฌู
- ูุชู ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุณุนุฑ ุชููุงุฆูุงู ุนูุฏ ุชุญุฏูุซ ุงูุจูุงูุงุช
- ุชู ุฅุตูุงุญ ูุดููุฉ ุฃู API ูุง ูุณุชุฎุฏู ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ ูู ุญุณุงุจ ุงูุณุนุฑ
- ุชู ุฒูุงุฏุฉ ุงูููู ุงูุงูุชุฑุงุถูุฉ ูุฌุนู ุงูุชุณุนูุฑ ุฃูุซุฑ ูุงูุนูุฉ
- ุชู ุฅูุดุงุก ุณูุฑูุจุช ุงุฎุชุจุงุฑ ููุชุฃูุฏ ูู ุตุญุฉ ุงูุชุณุนูุฑ
- ุชู ุฅุถุงูุฉ ุญููู ุฅุฏุฎุงู ูุจุงุดุฑุฉ ูุนุฏุฏ ุงูุนูุงุตุฑ ูุงูุญุฌู ูุนุฏุฏ ุงูุนูุงู
- ุชู ุฅุถุงูุฉ ูุตุงุฆุญ ูุฅุฑุดุงุฏุงุช ูููุณุชุฎุฏู ุญูู ููููุฉ ุชูุฏูุฑ ุงูุญุฌู

## ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช

```bash
npm run test:pricing
```
